# FreeGo 高性能框架

[![Go Version](https://img.shields.io/badge/go-%3E%3D1.21-blue.svg)](https://golang.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Go Report Card](https://goreportcard.com/badge/github.com/godaddy-x/freego)](https://goreportcard.com/report/github.com/godaddy-x/freego)

> 🚀 **专注于极致性能优化和金融级安全标准的 Go 语言企业级框架**

FreeGo 是一个高性能的 Go 语言企业级框架，专注于极致性能优化和金融级安全标准。框架由两大核心组件构成：

- **Server & API 框架**：基于 FastHTTP 构建的高性能 HTTP 服务
- **ORM 数据库框架**：零反射、零内存浪费的高性能数据库操作框架

## 📚 目录

- [🚀 框架特性](#框架特性)
- [🔧 快速开始](#快速开始)
- [🔐 安全特性](#安全特性)
- [📈 性能对比](#性能对比)
- [🗄️ ORM 特性](#orm-特性)
- [🎯 选择指南](#选择指南)

## 🚀 框架特性

### 🌐 Server & API 框架

| 特性             | 描述                             | 优势              |
| ---------------- | -------------------------------- | ----------------- |
| 🚀 高性能 HTTP   | 基于 FastHTTP，比标准库快 3-5 倍 | 单机 QPS 50,000+  |
| 🔐 金融级安全    | JWT + RSA/ECC + AES 加密         | 符合 PCI DSS 标准 |
| 🔒 防重放攻击    | HMAC-SHA256 + 时间戳             | 金融级安全保障    |
| 👥 RBAC 权限控制 | 角色权限管理系统                 | 企业级访问控制    |
| ⚡ 三级限流      | 网关/方法/用户限流               | 防止系统过载      |
| 🔧 过滤器链      | 完整的中间件系统                 | 支持自定义扩展    |

### 🗄️ ORM 数据库框架

| 特性          | 描述                  | 性能提升          |
| ------------- | --------------------- | ----------------- |
| 💾 零内存浪费 | 精确容量预分配        | 减少 90%+ GC 压力 |
| ⚡ 零反射开销 | 直接内存操作          | 编译时类型安全    |
| 🧠 智能预估   | 递归 OR 条件精确计算  | 复杂查询性能优化  |
| 🔄 高并发支持 | 智能连接池 + 原子操作 | 支持 10,000+ 并发 |

### 核心组件架构

```
┌─────────────────────────────────────────────────────────────────┐
│                      FreeGo Framework                           │
├─────────────────────────────────────────────────────────────────┤
│                   Application Layer (应用层)                     │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │  HTTP Server (FastHTTP)                                  │   │
│  │  • 单机 QPS: 50,000+                                     │   │
│  │  • 响应延迟: < 1ms                                       │   │
│  └──────────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────┤
│                  Filter Chain (过滤器链)                         │
│  ┌────────────┬────────────┬────────────┬────────────┬──────┐   │
│  │ 限流过滤器  │ 参数过滤器  │ 会话过滤器  │ 权限过滤器  │ 自定义│   │
│  └────────────┴────────────┴────────────┴────────────┴──────┘   │
├─────────────────────────────────────────────────────────────────┤
│                 Security & Crypto (安全层)                       │
│  ┌────────────┬────────────┬────────────┬────────────┬──────┐   │
│  │ JWT 认证   │ RSA/ECC 加密│ AES 加密   │ HMAC签名   │ 防重放│   │
│  └────────────┴────────────┴────────────┴────────────┴──────┘   │
├─────────────────────────────────────────────────────────────────┤
│                Business Logic Layer (业务层)                     │
│  ┌────────────┬────────────┬────────────┬────────────┬──────┐   │
│  │ 请求上下文  │ 路由管理    │ 中间件管理  │ 错误处理    │ 监控 │   │
│  └────────────┴────────────┴────────────┴────────────┴──────┘   │
├─────────────────────────────────────────────────────────────────┤
│                  ORM Layer (数据访问层)                          │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │  FreeGo ORM                                              │   │
│  │  • 零内存浪费 • 零反射开销 • 精确容量预估                  │   │
│  │  • 高并发优化，性能显著提升                                │   │
│  └──────────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────┤
│                 Database Layer (数据库层)                        │
│  ┌────────────┬────────────┬────────────┬────────────┬──────┐   │
│  │   MySQL    │ PostgreSQL │   MongoDB  │   Redis    │ 其他  │   │
│  └────────────┴────────────┴────────────┴────────────┴──────┘   │
└─────────────────────────────────────────────────────────────────┘

【性能指标】
• ECC 登录认证: 3,324 TPS       • AES 数据查询: 65,928 TPS
• 单条查询: 130,901 ns/op       • 批量查询: 8,931,733 ns/op
• 内存占用: 6.8MB/op           • GC压力: 93,139 allocs/op
• 并发连接: 10,000+           • CPU 使用: < 30%
```

## 🔧 快速开始

### 📦 安装

```bash
go get github.com/godaddy-x/freego
```

### 🚀 基础示例

```go
package main

import (
    "github.com/godaddy-x/freego/node"
    "github.com/godaddy-x/freego/utils/jwt"
)

func main() {
    httpNode := &node.HttpNode{}

    // 配置 JWT 认证
    httpNode.AddJwtConfig(jwt.JwtConfig{
        TokenKey: "your-256-bit-secret-key",
        TokenExp: jwt.ONE_HOUR,
    })

    // 添加路由
    httpNode.GET("/health", func(ctx *node.Context) error {
        return ctx.Json(map[string]interface{}{"status": "ok"})
    })

    // 启动服务
    httpNode.StartServer(":8080")
}
```

## 🔐 安全特性

### 多重认证体系

- **JWT Token**: 无状态认证，支持短过期时间
- **HMAC-SHA256**: 防止重放攻击和数据篡改
- **RSA/ECC 加密**: 非对称加密，金融级安全
- **AES 加密**: 对称加密，高性能数据传输

### 安全机制

- **时间戳验证**: 请求在 5 分钟窗口内有效
- **随机数防重放**: 每个请求使用唯一 nonce
- **双重签名**: Token + Secret 组合验证

## 📈 性能对比

### HTTP API 性能

| 测试场景     | TPS    | 响应时间 | 内存分配 |
| ------------ | ------ | -------- | -------- |
| ECC 登录认证 | 3,324  | 0.37ms   | 14KB     |
| AES 数据查询 | 65,928 | 0.02ms   | 9.7KB    |

### ORM 批量查询性能 (3000 行数据)

| 框架           | 处理时间 | 内存使用 | 相对性能 | 内存效率   |
| -------------- | -------- | -------- | -------- | ---------- |
| **sqlx**       | 6.84ms   | 8.61MB   | **基准** | ⭐⭐⭐⭐   |
| 原生 SQL       | 7.01ms   | 8.54MB   | +2.5%    | ⭐⭐⭐⭐⭐ |
| **FreeGo ORM** | 8.93ms   | 6.82MB   | +30.7%   | ⭐⭐⭐⭐⭐ |
| GORM           | 9.25ms   | 9.19MB   | +35.3%   | ⭐⭐⭐     |
| Beego ORM      | 13.62ms  | 15.85MB  | +99.2%   | ⭐⭐       |
| XORM           | 13.74ms  | 19.06MB  | +100.9%  | ⭐⭐       |

> **顺序模式测试**: 17 个字段完全公平对比，更真实反映实际业务场景

## 🗄️ ORM 特性

### 核心优化技术

- **零内存浪费**: 精确容量预分配，避免扩容
- **零反射开销**: 直接内存操作，编译时类型安全
- **智能预估**: 递归 OR 条件精确容量计算
- **高并发支持**: 原子操作和智能连接池

### 适用场景

- 高频数据库操作
- 大数据量处理
- 内存敏感应用
- 金融级数据系统

## 🎯 选择指南

### 选择 FreeGo 的理由

| 需求场景      | FreeGo 优势                 | 适用项目        |
| ------------- | --------------------------- | --------------- |
| 🚀 高性能     | 30.7%性能开销，内存节省 20% | 高并发 Web 服务 |
| 🔒 金融级安全 | PCI DSS 合规                | 金融、支付系统  |
| 💾 内存优化   | 6.8MB 内存使用，GC 压力最小 | 内存敏感应用    |
| 🗄️ 数据库密集 | 零反射 ORM，智能容量预估    | 数据密集型系统  |

### 快速部署

```bash
# Docker 部署
FROM golang:1.21-alpine
WORKDIR /app
COPY . .
RUN go build -o main .
CMD ["./main"]
```

## 📞 联系与支持

- 📧 **GitHub**: [https://github.com/godaddy-x/freego](https://github.com/godaddy-x/freego)
- 🐛 **Issues**: [报告问题](https://github.com/godaddy-x/freego/issues)
- 📖 **文档**: [详细文档](./README_SECURITY.md)

---

⭐ 如果这个项目对你有帮助，请给它一个 Star！
